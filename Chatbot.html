<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>"Chat with May AIüï∏"</title>
  <style>
    /* ‡§¨‡•á‡§∏‡§ø‡§ï ‡§≤‡•á‡§Ü‡§â‡§ü & ‡§´‡•ã‡§Ç‡§ü */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #FFFFFF5E, #B80000;
      display: flex;
      height: 100vh;
      transition: background-color 0.3s, color 0.3s;
    }
    .bubbles {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    overflow: hidden;
    z-index: -10;
}

.bubbles span {
    position: absolute;
    bottom: -100px;
    width: 20px;
    height: 20px;
    background: #C400FF;
    border-radius: 100%;
    opacity: 0.5;
    animation: bubbleAnimation linear infinite;
}

/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∏‡§æ‡§á‡§ú ‡§ï‡•á ‡§¨‡§¨‡§≤‡•ç‡§∏ */
.bubbles span:nth-child(1) { left: 10%; animation-duration: 8s; animation-delay: 0s; }
.bubbles span:nth-child(2) { left: 20%; animation-duration: 10s; animation-delay: 2s; width: 30px; height: 30px; }
.bubbles span:nth-child(3) { left: 35%; animation-duration: 12s; animation-delay: 4s; width: 25px; height: 25px; }
.bubbles span:nth-child(4) { left: 50%; animation-duration: 9s; animation-delay: 1s; width: 40px; height: 40px; }
.bubbles span:nth-child(5) { left: 65%; animation-duration: 7s; animation-delay: 3s; width: 20px; height: 20px; }
.bubbles span:nth-child(6) { left: 80%; animation-duration: 11s; animation-delay: 2s; width: 35px; height: 35px; }
.bubbles span:nth-child(7) { left: 90%; animation-duration: 13s; animation-delay: 5s; width: 45px; height: 45px; }
.bubbles span:nth-child(8) { left: 75%; animation-duration: 8s; animation-delay: 5s; width: 25px; height: 25px; }
.bubbles span:nth-child(9) { left: 90%; animation-duration: 13s; animation-delay: 5s; width: 45px; height: 45px; }
.bubbles span:nth-child(10) { center: 90%; animation-duration: 3s; animation-delay: 5s; width: 45px; height: 45px; }

/* ‡§¨‡§¨‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§® */
@keyframes bubbleAnimation {
    0% {
        transform: translateY(0);
        opacity: 0.5;
    }
    50% {
        opacity: 1;
    }
    100% {
        transform: translateY(-100vh);
        opacity: 0;
    }
}


    /* ‡§∏‡§æ‡§á‡§°‡§¨‡§æ‡§∞ (‡§ö‡•à‡§ü ‡§∏‡§§‡•ç‡§∞ ‡§∏‡•Ç‡§ö‡•Ä) */
    .sidebar {
      width: 250px;
      background: #FCFCFF;
      border-right: 1px solid #ccc;
      padding: 10px;
      overflow-y: auto;
    }
    .sidebar h2 {
      font-size: 18px;
      margin-top: 0;
    }
    .session-item {
      padding: 8px;
      margin: 5px 0;
      cursor: pointer;
      border: 1px solid #ddd;
      border-radius: 3px;
      position: relative;
    }
    .session-item.active {
      background: #e0e0e0;
    }
    .session-item button.delete-session {
      position: absolute;
      right: 5px;
      top: 5px;
      background: #f44336;
      border: none;
      color: #fff;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      cursor: pointer;
      font-size: 12px;
      line-height: 18px;
    }
    .new-session-btn {
      width: 100%;
      padding: 8px;
      margin-top: 10px;
      background: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    .new-session-btn:hover {
      background: #45a049;
    }
    /* ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ö‡•à‡§ü ‡§µ‡§ø‡§Ç‡§°‡•ã */
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .chat-header {
      padding: 10px;
      background: #fff;
      border-bottom: 1px solid #ccc;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .clear-chat-btn {
      padding: 5px 10px;
      background: #f44336;
      color: #fff;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    .clear-chat-btn:hover {
      background: #d32f2f;
    }
    #chat-window {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #FFFFFF;
    }
    .message {
      margin: 10px 0;
      padding: 8px 12px;
      border-radius: 20px;
      word-wrap: break-word;
      position: relative;
    }
    .message span.timestamp {
      display: block;
      font-size: 10px;
      color: #777777;
      margin-top: 4px;
      text-align: right;
    }
    .user {
      background: #000000;
      align-self: flex-end;
      text-align: right;
      color: #FFFFFF;
    }
    .bot {
      background: #052BFFE0;
      align-self: flex-start;
      text-align: left;
      color: #FFFFFF;
    }
    .input-area {
      display: flex;
      border-top: 1px solid #ccc;
      padding: 10px;
      background: #fff;
    }
    #user-input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    #send-button {
      padding: 10px 15px;
      margin-left: 10px;
      border: none;
      background: #037EBC;
      color: #FFFFFF;
      font-size: 16px;
      cursor: pointer;
      border-radius: 3px;
    }
    #send-button:hover {
      background: #45a049;
    }
    #typing-indicator {
      font-size: 20px;
      color: #3F6742;
      margin: 10px;
      display: none;
    }
  </style>
</head>
<body>
    <div class="bubbles">
        <span>1</span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>
    
  <!-- ‡§∏‡§æ‡§á‡§°‡§¨‡§æ‡§∞: ‡§ö‡•à‡§ü ‡§∏‡§§‡•ç‡§∞ ‡§∏‡•Ç‡§ö‡•Ä -->
  <div class="sidebar">
    <h2>Chat</h2>
    <div id="session-list"><!-- ‡§∏‡§§‡•ç‡§∞ ‡§Ü‡§á‡§ü‡§Æ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•á --></div>
    <button class="new-session-btn" id="new-session-btn">New Chat</button>
  </div>
  
  <!-- ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ö‡•à‡§ü ‡§µ‡§ø‡§Ç‡§°‡•ã -->
  <div class="chat-container">
    <div class="chat-header">
      <span id="session-title">chat</span>
      <button class="clear-chat-btn" id="clear-chat-btn">All chat deleted</button>
    </div>
    <div id="chat-window"><!-- ‡§ö‡•à‡§ü ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ø‡§π‡§æ‡§Å ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§π‡•ã‡§Ç‡§ó‡•á --></div>
    <div id="typing-indicator">‚óè‚óè‚óè</div>
    <div class="input-area">
      <input type="text" id="user-input" 
      placeholder="type your massage...." autocomplete="off">
      <button id="send-button">‚¨ÜÔ∏è</button>
    </div>
  </div>
  
  <script>
    /******************************************************************
     * JSON DATA ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ (data.json)
     ******************************************************************/
    // data.json ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ (‡§â‡§¶‡§æ‡§π‡§∞‡§£):
    // {
    //   "knowledgeBase": [ { "question": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á", "answer": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§ï‡•à‡§∏‡•á ‡§π‡•ã ‡§Ü‡§™?" }, ... ],
    //   "extendedData": [ { "question": "free fire ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à", "answer": "Free Fire ..." }, ... ],
    //   "subjectData": { "‡§á‡§Ç‡§°‡§ø‡§Ø‡§æ": "‡§á‡§Ç‡§°‡§ø‡§Ø‡§æ ‡§∏‡§¨‡§∏‡•á ‡§∏‡•Å‡§®‡•ç‡§¶‡§∞, ‡§Ü‡§õ‡•ç‡§õ‡§æ ‡§ì‡§∞ ‡§è‡§∏‡§ø‡§Ø‡§Æ‡•á ‡§¨‡§∏‡§æ ‡§π‡•Å‡§Ü ‡§¶‡•á‡§∏ ‡§π‡•á‡•§", ... },
    //   "jokes": [ "‡§ú‡•ã‡§º‡§ï 1", "‡§ú‡•ã‡§º‡§ï 2", ... ],
    //   "quotes": [ "‡§â‡§¶‡•ç‡§ß‡§∞‡§£ 1", "‡§â‡§¶‡•ç‡§ß‡§∞‡§£ 2", ... ]
    // }
    let knowledgeBase = [];
    let extendedData = [];
    let bestanswer = [];
    let subjectData = {};
    let jokes = [];
    let quotes = [];
    
    function loadData() {
      return fetch('data.json')
        .then(response => response.json())
        .then(data => {
          knowledgeBase = data.knowledgeBase;
          extendedData = data.extendedData;
          bestanswer = data.bestanswer;
          subjectData = data.subjectData;
          jokes = data.jokes;
          quotes = data.quotes;
        })
        .catch(err => console.error("JSON ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:", err));
    }
    
    /******************************************************************
     * ‡§Ö‡§®‡•ç‡§Ø ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤‡•ç‡§∏ ‡§î‡§∞ ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§®
     ******************************************************************/
    let pendingQuestion = null;
    let editingKnowledgeEntry = null;
    const synonyms = {
      "my": "‡§Æ‡•á‡§∞‡§æ",
      "name": "‡§®‡§æ‡§Æ",
      "is": "‡§π‡•à",
      "hi": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á",
      "hello": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á",
       
  "good": "‡§Ö‡§ö‡•ç‡§õ‡§æ",
  "bad": "‡§¨‡•Å‡§∞‡§æ",
  "morning": "‡§∏‡•Å‡§¨‡§π",
  "night": "‡§∞‡§æ‡§§",
  "food": "‡§≠‡•ã‡§ú‡§®",
  "water": "‡§™‡§æ‡§®‡•Ä",
  "sun": "‡§∏‡•Ç‡§∞‡§ú",
  "moon": "‡§ö‡§æ‡§Å‡§¶",
  "star": "‡§§‡§æ‡§∞‡§æ",
  "earth": "‡§™‡•É‡§•‡•ç‡§µ‡•Ä",
  "sky": "‡§Ü‡§∏‡§Æ‡§æ‡§®",
  "friend": "‡§¶‡•ã‡§∏‡•ç‡§§",
  "family": "‡§™‡§∞‡§ø‡§µ‡§æ‡§∞",
  "love": "‡§™‡•ç‡§∞‡•á‡§Æ",
  "happy": "‡§ñ‡•Å‡§∂",
  "sad": "‡§â‡§¶‡§æ‡§∏",
  "fast": "‡§§‡•á‡§ú‡§º",
  "slow": "‡§ß‡•Ä‡§Æ‡§æ",
  "run": "‡§¶‡•å‡§°‡§º‡§®‡§æ",
  "walk": "‡§ö‡§≤‡§®‡§æ",
  "speak": "‡§¨‡•ã‡§≤‡§®‡§æ",
  "write": "‡§≤‡§ø‡§ñ‡§®‡§æ",
  "read": "‡§™‡§¢‡§º‡§®‡§æ",
  "see": "‡§¶‡•á‡§ñ‡§®‡§æ",
  "hear": "‡§∏‡•Å‡§®‡§®‡§æ",
  "think": "‡§∏‡•ã‡§ö‡§®‡§æ",
  "work": "‡§ï‡§æ‡§Æ",
  "home": "‡§ò‡§∞",
  "school": "‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø",
  "teacher": "‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï",
  "student": "‡§õ‡§æ‡§§‡•ç‡§∞",
  "computer": "‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞",
  "mobile": "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤",
  "internet": "‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü",
  "coding": "‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó",
  "language": "‡§≠‡§æ‡§∑‡§æ",
  "password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "username": "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ",
  "login": "‡§≤‡•â‡§ó‡§ø‡§®",
  "logout": "‡§≤‡•â‡§ó‡§Ü‡§â‡§ü",
  "encrypt": "‡§è‡§®‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü",
  "decrypt": "‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü",
  "security": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ",
  "authentication": "‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "authorization": "‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§®",
  "access": "‡§™‡•ç‡§∞‡§µ‡•á‡§∂",
  "protected": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§",
  "hashing": "‡§π‡•à‡§∂‡§ø‡§Ç‡§ó",
  "salt": "‡§∏‡•â‡§≤‡•ç‡§ü",
  "key": "‡§ï‡•Å‡§Ç‡§ú‡•Ä",
  "token": "‡§ü‡•ã‡§ï‡§®",
  "credential": "‡§™‡•ç‡§∞‡§Æ‡§æ‡§£ ‡§™‡§§‡•ç‡§∞",
  "privacy": "‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ",
  "secure": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§",
  "hacker": "‡§π‡•à‡§ï‡§∞",
  "brute force": "‡§¨‡•ç‡§∞‡•Ç‡§ü ‡§´‡•ã‡§∞‡•ç‡§∏",
  "phishing": "‡§´‡§ø‡§∂‡§ø‡§Ç‡§ó",
  "malware": "‡§Æ‡•à‡§≤‡§µ‡•á‡§Ø‡§∞",
  "two-factor authentication": "‡§¶‡•ç‡§µ‡§ø-‡§ï‡§æ‡§∞‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "forgot password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§≠‡•Ç‡§≤ ‡§ó‡§è",
  "reset password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
  "password strength": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•Ä ‡§Æ‡§ú‡§¨‡•Ç‡§§‡•Ä",
  "strong password": "‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "weak password": "‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "password manager": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï",
  "OTP": "‡§ì‡§ü‡•Ä‡§™‡•Ä (‡§µ‡§® ‡§ü‡§æ‡§á‡§Æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°)",
  "passcode": "‡§™‡§æ‡§∏‡§ï‡•ã‡§°",
  "PIN": "‡§™‡§ø‡§® (‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§™‡§π‡§ö‡§æ‡§® ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ)",
  "biometric authentication": "‡§¨‡§æ‡§Ø‡•ã‡§Æ‡•á‡§ü‡•ç‡§∞‡§ø‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "fingerprint": "‡§´‡§ø‡§Ç‡§ó‡§∞‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü",
  "face recognition": "‡§ö‡•á‡§π‡§∞‡§æ ‡§™‡§π‡§ö‡§æ‡§®",
  "security question": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®",
  "password policy": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§®‡•Ä‡§§‡§ø",
  "password recovery": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§ø",
  "password expiration": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø",
  "data breach": "‡§°‡•á‡§ü‡§æ ‡§â‡§≤‡•ç‡§≤‡§Ç‡§ò‡§®",
  "password generator": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ú‡§®‡§∞‡•á‡§ü‡§∞",
  "dictionary attack": "‡§°‡§ø‡§ï‡•ç‡§∂‡§®‡§∞‡•Ä ‡§Ö‡§ü‡•à‡§ï",
  "rainbow table attack": "‡§∞‡•á‡§®‡§¨‡•ã ‡§ü‡•á‡§¨‡§≤ ‡§Ö‡§ü‡•à‡§ï",
  "multi-factor authentication": "‡§¨‡§π‡•Å-‡§ï‡§æ‡§∞‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "session timeout": "‡§∏‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø",
  "captcha": "‡§ï‡•à‡§™‡•ç‡§ö‡§æ",
  "lockout": "‡§≤‡•â‡§ï‡§Ü‡§â‡§ü",
  "recovery email": "‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§ø ‡§à‡§Æ‡•á‡§≤",
  "backup code": "‡§¨‡•à‡§ï‡§Ö‡§™ ‡§ï‡•ã‡§°",
  "security breach": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§≤‡•ç‡§≤‡§Ç‡§ò‡§®",
  "firewall": "‡§´‡§º‡§æ‡§Ø‡§∞‡§µ‡•â‡§≤",
  "cyber attack": "‡§∏‡§æ‡§á‡§¨‡§∞ ‡§π‡§Æ‡§≤‡§æ",
  "password hint": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§Ç‡§ï‡•á‡§§",
  "keystroke logging": "‡§ï‡•Ä‡§∏‡•ç‡§ü‡•ç‡§∞‡•ã‡§ï ‡§≤‡•â‡§ó‡§ø‡§Ç‡§ó",
  "session hijacking": "‡§∏‡§§‡•ç‡§∞ ‡§Ö‡§™‡§π‡§∞‡§£",
  "zero trust security": "‡§ú‡§º‡•Ä‡§∞‡•ã ‡§ü‡•ç‡§∞‡§∏‡•ç‡§ü ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ",
  "hash function": "‡§π‡•à‡§∂ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§®",
  "MD5": "‡§è‡§Æ‡§°‡•Ä5",
  "SHA": "‡§è‡§∏‡§è‡§ö‡§è (‡§∏‡§ø‡§ï‡•ç‡§Ø‡•ã‡§∞ ‡§π‡•à‡§∂ ‡§è‡§≤‡•ç‡§ó‡•ã‡§∞‡§ø‡§¶‡§Æ)",
  "password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "username": "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ",
  "login": "‡§≤‡•â‡§ó‡§ø‡§®",
  "logout": "‡§≤‡•â‡§ó‡§Ü‡§â‡§ü",
  "register": "‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£",
  "forgot password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§≠‡•Ç‡§≤ ‡§ó‡§è",
  "reset password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
  "change password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¨‡§¶‡§≤‡•á‡§Ç",
  "password strength": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•Ä ‡§Æ‡§ú‡§¨‡•Ç‡§§‡•Ä",
  "strong password": "‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "weak password": "‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
  "password match": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§≤ ‡§ñ‡§æ‡§§‡§æ ‡§π‡•à",
  "password mismatch": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡§æ‡§§‡§æ",
  "show password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç",
  "hide password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§õ‡•Å‡§™‡§æ‡§è‡§Ç",
  "confirm password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç",
  "security question": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®",
  "OTP": "‡§ì‡§ü‡•Ä‡§™‡•Ä (‡§µ‡§® ‡§ü‡§æ‡§á‡§Æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°)",
  "authentication": "‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "two-factor authentication": "‡§¶‡•ç‡§µ‡§ø-‡§ï‡§æ‡§∞‡§ï ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£",
  "auto-fill password": "‡§∏‡•ç‡§µ‡§§‡§É ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç",
  "password manager": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï",
  "save password": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§π‡•á‡§ú‡•á‡§Ç",
  "password encryption": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§è‡§®‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§®",
  "password decryption": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§°‡§ø‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§®",
  "password policy": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§®‡•Ä‡§§‡§ø",
  "password expiry": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø",
  "password update": "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç",
  "secure login": "‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§≤‡•â‡§ó‡§ø‡§®",
  "session timeout": "‡§∏‡§§‡•ç‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø",
  "lock screen": "‡§≤‡•â‡§ï ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®",
  "hello": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á",
  "hi": "‡§®‡§Æ‡§∏‡•ç‡§§‡•á",
  "how are you": "‡§Ü‡§™ ‡§ï‡•à‡§∏‡•á ‡§π‡•à‡§Ç?",
  "I am fine": "‡§Æ‡•à‡§Ç ‡§†‡•Ä‡§ï ‡§π‡•Ç‡§Å",
  "what is your name": "‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
  "my name is": "‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à",
  "nice to meet you": "‡§Ü‡§™‡§∏‡•á ‡§Æ‡§ø‡§≤‡§ï‡§∞ ‡§ñ‡•Å‡§∂‡•Ä ‡§π‡•Å‡§à",
  "good morning": "‡§∏‡•Å‡§™‡•ç‡§∞‡§≠‡§æ‡§§",
  "good night": "‡§∂‡•Å‡§≠ ‡§∞‡§æ‡§§‡•ç‡§∞‡§ø",
  "goodbye": "‡§Ö‡§≤‡§µ‡§ø‡§¶‡§æ",
  "see you later": "‡§´‡§ø‡§∞ ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á",
  "thank you": "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶",
  "you're welcome": "‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à",
  "please": "‡§ï‡•É‡§™‡§Ø‡§æ",
  "sorry": "‡§Æ‡§æ‡§´‡§º ‡§ï‡•Ä‡§ú‡§ø‡§è",
  "excuse me": "‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç",
  "yes": "‡§π‡§æ‡§Å",
  "no": "‡§®‡§π‡•Ä‡§Ç",
  "maybe": "‡§∂‡§æ‡§Ø‡§¶",
  "what are you doing": "‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç?",
  "where are you from": "‡§Ü‡§™ ‡§ï‡§π‡§æ‡§Å ‡§∏‡•á ‡§π‡•à‡§Ç?",
  "I am from": "‡§Æ‡•à‡§Ç ... ‡§∏‡•á ‡§π‡•Ç‡§Å",
  "how old are you": "‡§Ü‡§™‡§ï‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
  "I don't know": "‡§Æ‡•Å‡§ù‡•á ‡§®‡§π‡•Ä‡§Ç ‡§™‡§§‡§æ",
  "can you help me": "‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§Æ‡•á‡§∞‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç?",
  "I understand": "‡§Æ‡•à‡§Ç ‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ",
  "I don't understand": "‡§Æ‡•Å‡§ù‡•á ‡§∏‡§Æ‡§ù ‡§®‡§π‡•Ä‡§Ç ‡§Ü‡§Ø‡§æ",
  "let's go": "‡§ö‡§≤‡•ã ‡§ö‡§≤‡§§‡•á ‡§π‡•à‡§Ç",
  "wait a moment": "‡§è‡§ï ‡§ï‡•ç‡§∑‡§£ ‡§∞‡•Å‡§ï‡•ã",
  "congratulations": "‡§¨‡§ß‡§æ‡§à ‡§π‡•ã",
  "best of luck": "‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Å",
  "take care": "‡§Ö‡§™‡§®‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§∞‡§ñ‡§®‡§æ",
  "what's up": "‡§ï‡•ç‡§Ø‡§æ ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à?",
  "nothing much": "‡§ï‡•Å‡§õ ‡§ñ‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç",
  "how was your day": "‡§Ü‡§™‡§ï‡§æ ‡§¶‡§ø‡§® ‡§ï‡•à‡§∏‡§æ ‡§∞‡§π‡§æ?",
  "it was good": "‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§•‡§æ",
  "it was bad": "‡§ñ‡§∞‡§æ‡§¨ ‡§•‡§æ",
  "what do you like": "‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§™‡§∏‡§Ç‡§¶ ‡§π‡•à?",
  "I like it": "‡§Æ‡•Å‡§ù‡•á ‡§Ø‡§π ‡§™‡§∏‡§Ç‡§¶ ‡§π‡•à",
  "I don't like it": "‡§Æ‡•Å‡§ù‡•á ‡§Ø‡§π ‡§™‡§∏‡§Ç‡§¶ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à",
  "do you speak Hindi": "‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§¨‡•ã‡§≤‡§§‡•á ‡§π‡•à‡§Ç?",
  "I speak a little Hindi": "‡§Æ‡•à‡§Ç ‡§•‡•ã‡§°‡§º‡•Ä ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§¨‡•ã‡§≤‡§§‡§æ ‡§π‡•Ç‡§Å",
  "what is happening": "‡§ï‡•ç‡§Ø‡§æ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à?",
  "where are you going": "‡§Ü‡§™ ‡§ï‡§π‡§æ‡§Å ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç?",
  "I am going home": "‡§Æ‡•à‡§Ç ‡§ò‡§∞ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å",
  "I am busy": "‡§Æ‡•à‡§Ç ‡§µ‡•ç‡§Ø‡§∏‡•ç‡§§ ‡§π‡•Ç‡§Å",
  "I am free": "‡§Æ‡•à‡§Ç ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•Ç‡§Å",
  "let‚Äôs meet": "‡§ö‡§≤‡•ã ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç",
  "call me later": "‡§Æ‡•Å‡§ù‡•á ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ",
  "I will call you": "‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•Ç‡§Ç‡§ó‡§æ",
  "do you need help": "‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§ï‡•ã ‡§Æ‡§¶‡§¶ ‡§ö‡§æ‡§π‡§ø‡§è?",
  "I am hungry": "‡§Æ‡•Å‡§ù‡•á ‡§≠‡•Ç‡§ñ ‡§≤‡§ó‡•Ä ‡§π‡•à",
  "I am thirsty": "‡§Æ‡•Å‡§ù‡•á ‡§™‡•ç‡§Ø‡§æ‡§∏ ‡§≤‡§ó‡•Ä ‡§π‡•à",
  "where is the washroom": "‡§µ‡•â‡§∂‡§∞‡•Ç‡§Æ ‡§ï‡§π‡§æ‡§Å ‡§π‡•à?",
  "what time is it": "‡§ï‡§ø‡§§‡§®‡•á ‡§¨‡§ú‡•á ‡§π‡•à‡§Ç?",
  "I am tired": "‡§Æ‡•à‡§Ç ‡§•‡§ï ‡§ó‡§Ø‡§æ ‡§π‡•Ç‡§Å",
  "what do you think": "‡§Ü‡§™‡§ï‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§π‡•à?",
  "I agree": "‡§Æ‡•à‡§Ç ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å",
  "I disagree": "‡§Æ‡•à‡§Ç ‡§Ö‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Å",
  "it's okay": "‡§ï‡•ã‡§à ‡§¨‡§æ‡§§ ‡§®‡§π‡•Ä‡§Ç",
  "don't worry": "‡§ö‡§ø‡§Ç‡§§‡§æ ‡§Æ‡§§ ‡§ï‡§∞‡•ã",
  "be careful": "‡§∏‡§æ‡§µ‡§ß‡§æ‡§® ‡§∞‡§π‡•á‡§Ç",
  "hurry up": "‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§ï‡§∞‡•ã",
  "slow down": "‡§ß‡•Ä‡§∞‡•á ‡§ö‡§≤‡•ã",
  "let‚Äôs go out": "‡§ö‡§≤‡•ã ‡§¨‡§æ‡§π‡§∞ ‡§ö‡§≤‡§§‡•á ‡§π‡•à‡§Ç",
  "have fun": "‡§Æ‡§ú‡§º‡•á ‡§ï‡§∞‡•ã",
  "enjoy your day": "‡§Ö‡§™‡§®‡•á ‡§¶‡§ø‡§® ‡§ï‡§æ ‡§Ü‡§®‡§Ç‡§¶ ‡§≤‡•ã",
  "how is everything": "‡§∏‡§¨ ‡§ï‡•à‡§∏‡§æ ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à?",
  "everything is fine": "‡§∏‡§¨ ‡§†‡•Ä‡§ï ‡§π‡•à",
  "long time no see": "‡§¨‡§π‡•Å‡§§ ‡§∏‡§Æ‡§Ø ‡§¨‡§æ‡§¶ ‡§Æ‡§ø‡§≤‡•á",
  "what are you thinking": "‡§Ü‡§™ ‡§ï‡•ç‡§Ø‡§æ ‡§∏‡•ã‡§ö ‡§∞‡§π‡•á ‡§π‡•à‡§Ç?",
  "just kidding": "‡§Æ‡•à‡§Ç ‡§Æ‡§ú‡§æ‡§ï ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å",
  "I am serious": "‡§Æ‡•à‡§Ç ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§π‡•Ç‡§Å",
  "really": "‡§∏‡§ö ‡§Æ‡•á‡§Ç?",
  "of course": "‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤",
  "that's great": "‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à",
  "that's terrible": "‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§¨‡•Å‡§∞‡§æ ‡§π‡•à",
  "don't be sad": "‡§â‡§¶‡§æ‡§∏ ‡§Æ‡§§ ‡§π‡•ã",
  "cheer up": "‡§ñ‡•Å‡§∂ ‡§π‡•ã ‡§ú‡§æ‡§ì",
  "what's new": "‡§®‡§Ø‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
  "same as always": "‡§π‡§Æ‡•á‡§∂‡§æ ‡§ï‡•Ä ‡§§‡§∞‡§π",
  "I have no idea": "‡§Æ‡•Å‡§ù‡•á ‡§ï‡•ã‡§à ‡§Ö‡§Ç‡§¶‡§æ‡§ú‡§æ ‡§®‡§π‡•Ä‡§Ç",
  "let me think": "‡§Æ‡•Å‡§ù‡•á ‡§∏‡•ã‡§ö‡§®‡•á ‡§¶‡•ã",
  "tell me more": "‡§Æ‡•Å‡§ù‡•á ‡§î‡§∞ ‡§¨‡§§‡§æ‡§ì",
  "that's interesting": "‡§Ø‡§π ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§π‡•à",
  "I am bored": "‡§Æ‡•à‡§Ç ‡§¨‡•ã‡§∞ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å",
  "I am excited": "‡§Æ‡•à‡§Ç ‡§â‡§§‡•ç‡§∏‡§æ‡§π‡§ø‡§§ ‡§π‡•Ç‡§Å",
  "calm down": "‡§∂‡§æ‡§Ç‡§§ ‡§π‡•ã ‡§ú‡§æ‡§ì",
  "don't panic": "‡§ò‡§¨‡§∞‡§æ‡§ì ‡§Æ‡§§",
  "take it easy": "‡§Ü‡§∞‡§æ‡§Æ ‡§∏‡•á ‡§≤‡•ã",
  "it doesn't matter": "‡§ï‡•ã‡§à ‡§´‡§∞‡•ç‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§™‡§°‡§º‡§§‡§æ",
  "never mind": "‡§ï‡•ã‡§à ‡§¨‡§æ‡§§ ‡§®‡§π‡•Ä‡§Ç",
  "I hope so": "‡§Æ‡•Å‡§ù‡•á ‡§Ü‡§∂‡§æ ‡§π‡•à",
  "what a surprise": "‡§ï‡•ç‡§Ø‡§æ ‡§∏‡§∞‡§™‡•ç‡§∞‡§æ‡§á‡§ú‡§º ‡§π‡•à!",
  "I am proud of you": "‡§Æ‡•Å‡§ù‡•á ‡§§‡•Å‡§Æ ‡§™‡§∞ ‡§ó‡§∞‡•ç‡§µ ‡§π‡•à",
  "better luck next time": "‡§Ö‡§ó‡§≤‡•Ä ‡§¨‡§æ‡§∞ ‡§ï‡§ø‡§∏‡•ç‡§Æ‡§§ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•ã‡§ó‡•Ä",
  "do your best": "‡§Ö‡§™‡§®‡•Ä ‡§™‡•Ç‡§∞‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•ã",
  "I trust you": "‡§Æ‡•Å‡§ù‡•á ‡§§‡•Å‡§Æ ‡§™‡§∞ ‡§≠‡§∞‡•ã‡§∏‡§æ ‡§π‡•à",
  "don't give up": "‡§π‡§æ‡§∞ ‡§Æ‡§§ ‡§Æ‡§æ‡§®‡•ã",
  "I need some rest": "‡§Æ‡•Å‡§ù‡•á ‡§•‡•ã‡§°‡§º‡§æ ‡§Ü‡§∞‡§æ‡§Æ ‡§ö‡§æ‡§π‡§ø‡§è",
  "I will be right back": "‡§Æ‡•à‡§Ç ‡§Ö‡§≠‡•Ä ‡§µ‡§æ‡§™‡§∏ ‡§Ü‡§§‡§æ ‡§π‡•Ç‡§Å",
  "can we talk": "‡§ï‡•ç‡§Ø‡§æ ‡§π‡§Æ ‡§¨‡§æ‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç?",
  "give me a minute": "‡§Æ‡•Å‡§ù‡•á ‡§è‡§ï ‡§Æ‡§ø‡§®‡§ü ‡§¶‡•ã",
  "I am on my way": "‡§Æ‡•à‡§Ç ‡§∞‡§æ‡§∏‡•ç‡§§‡•á ‡§Æ‡•á‡§Ç ‡§π‡•Ç‡§Å",
  "stay strong": "‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§¨‡§®‡•á ‡§∞‡§π‡•ã"


};
    
    let sessions = JSON.parse(localStorage.getItem("chatSessions")) || [];
    let currentSessionId = localStorage.getItem("currentSessionId") || null;
    if (!currentSessionId || sessions.length === 0) {
      currentSessionId = "session-" + Date.now();
      let newSession = { id: currentSessionId, title: "New Chat", messages: [] };
      sessions.push(newSession);
      localStorage.setItem("chatSessions", JSON.stringify(sessions));
      localStorage.setItem("currentSessionId", currentSessionId);
    }
    
    let chatbotPersonality = "formal";  // ‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï: "informal"
    let user_context = {
      name: null,
      last_intent: null,
      conversation: []  // ‡§™‡•Ç‡§∞‡•á ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°
    };
    let darkMode = false;
    
    /******************************************************************
     * HELPER FUNCTIONS: ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ, ‡§ü‡§æ‡§á‡§Æ‡§∏‡•ç‡§ü‡•à‡§Æ‡•ç‡§™, ‡§®‡•â‡§∞‡•ç‡§Æ‡§≤‡§æ‡§á‡§ú‡•á‡§∂‡§® ‡§Ü‡§¶‡§ø
     ******************************************************************/
    function escapeHTML(str) {
      return str.replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
    }
    
    function getTimestamp() {
      let now = new Date();
      return now.getHours().toString().padStart(2, "0") + ":" +
             now.getMinutes().toString().padStart(2, "0");
    }
    
    function normalizeText(text) {
      return text.split(" ").map(word => {
        let lw = word.toLowerCase();
        return synonyms[lw] ? synonyms[lw] : lw;
      }).join(" ");
    }
    
    function translateToHindi(text) {
      let lower = text.toLowerCase();
      if(lower.indexOf("my name is") !== -1) {
        return text.replace(/my name is/gi, "‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à");
      }
      return text;
    }
    
    /******************************************************************
     * SENTIMENT ANALYSIS FUNCTION
     ******************************************************************/
    const positiveWords = ["‡§Ö‡§ö‡•ç‡§õ‡§æ", "‡§ñ‡•Å‡§∂", "‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ", "‡§∂‡§æ‡§®‡§¶‡§æ‡§∞", "‡§∏‡•Å‡§®‡•ç‡§¶‡§∞"];
    const negativeWords = ["‡§¨‡•Å‡§∞‡§æ", "‡§¶‡•Å‡§ñ", "‡§ñ‡§∞‡§æ‡§¨", "‡§â‡§¶‡§æ‡§∏", "‡§®‡§æ‡§™‡§∏‡§Ç‡§¶"];
    function analyzeSentiment(message) {
      let words = message.split(" ");
      let posCount = 0, negCount = 0;
      words.forEach(word => {
        let lw = word.toLowerCase();
        if (positiveWords.includes(lw)) posCount++;
        if (negativeWords.includes(lw)) negCount++;
      });
      if (posCount > negCount) return "positive";
      else if (negCount > posCount) return "negative";
      else return "neutral";
    }
    
    /******************************************************************
     * INTENT-BASED SYSTEM FUNCTIONS
     ******************************************************************/
    const intents = {
      greet: {
        keywords: ["‡§®‡§Æ‡§∏‡•ç‡§§‡•á", "‡§π‡§æ‡§Ø", "hello", "hi"],
        responses: {
          formal: ["{greeting_time}! ‡§ï‡•à‡§∏‡•á ‡§π‡•ã ‡§Ü‡§™?", "{greeting_time}! ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à‡•§"],
          informal: ["{greeting_time} ‡§¶‡•ã‡§∏‡•ç‡§§! ‡§ï‡•ç‡§Ø‡§æ ‡§π‡§æ‡§≤ ‡§π‡•à?", "{greeting_time}! ‡§ï‡•à‡§∏‡§æ ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à?"]
        }
      },
      how_are_you: {
        keywords: ["‡§ï‡•à‡§∏‡•á ‡§π‡•ã", "‡§ï‡•ç‡§Ø‡§æ ‡§π‡§æ‡§≤ ‡§π‡•à", "how are you"],
        responses: {
          formal: ["‡§Æ‡•à‡§Ç ‡§†‡•Ä‡§ï ‡§π‡•Ç‡§Å, ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!", "‡§∏‡§¨ ‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ ‡§π‡•à‡•§"],
          informal: ["‡§Æ‡•à‡§Ç ‡§Æ‡§∏‡•ç‡§§ ‡§π‡•Ç‡§Å!", "‡§¨‡§ø‡§≤‡§ï‡•Å‡§≤ ‡§ü‡•â‡§™, ‡§∂‡•Å‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ!"]
        }
      },
      goodbye: {
        keywords: ["‡§Ö‡§≤‡§µ‡§ø‡§¶‡§æ", "‡§¨‡§æ‡§Ø", "‡§´‡§ø‡§∞ ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á"],
        responses: {
          formal: ["‡§Ö‡§≤‡§µ‡§ø‡§¶‡§æ!", "‡§´‡§ø‡§∞ ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á!", "‡§Ü‡§™‡§ï‡§æ ‡§¶‡§ø‡§® ‡§∂‡•Å‡§≠ ‡§π‡•ã‡•§"],
          informal: ["‡§¨‡§æ‡§Ø ‡§¶‡•ã‡§∏‡•ç‡§§!", "‡§ö‡§≤‡•ã ‡§´‡§ø‡§∞, ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç!", "‡§Ö‡§≤‡§µ‡§ø‡§¶‡§æ, ‡§´‡§ø‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á‡•§"]
        }
      },
      dhaval: {
       keywords: ["Gameti", "Narayan", "best"]
          ,
        response: {
          formal: ["GamrtiDhaval", "visva vijeta","Gametin"],
          informal: ["Sale kutte", "bhosadike", "baharja"]
        }
      },
      thanks: {
        keywords: ["‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶", "‡§•‡•à‡§Ç‡§ï‡•ç‡§∏", "‡§∂‡•Å‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ"],
        responses: {
          formal: ["‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!", "‡§ï‡•ã‡§à ‡§¨‡§æ‡§§ ‡§®‡§π‡•Ä‡§Ç!", "‡§Æ‡•á‡§∞‡§æ ‡§∏‡•å‡§≠‡§æ‡§ó‡•ç‡§Ø ‡§π‡•à!"],
          informal: ["‡§ï‡•ã‡§à ‡§¨‡§æ‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§Ø‡§æ‡§∞!", "‡§¨‡§ø‡§≤‡§ï‡•Å‡§≤!", "‡§ñ‡•Å‡§∂‡•Ä ‡§π‡•Å‡§à!"]
        }
      }
    };
    
    function get_greeting_time() {
      const hour = new Date().getHours();
      if (hour >= 5 && hour < 12) return "‡§∏‡•Å‡§™‡•ç‡§∞‡§≠‡§æ‡§§";
      else if (hour >= 12 && hour < 17) return "‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞";
      else if (hour >= 17 && hour < 21) return "‡§∂‡•Å‡§≠ ‡§∏‡§Ç‡§ß‡•ç‡§Ø‡§æ";
      else return "‡§∂‡•Å‡§≠ ‡§∞‡§æ‡§§‡•ç‡§∞‡§ø";
    }
    
    function levenshtein(a, b) {
      const matrix = [];
      for (let i = 0; i <= b.length; i++) { matrix[i] = [i]; }
      for (let j = 0; j <= a.length; j++) { matrix[0][j] = j; }
      for (let i = 1; i <= b.length; i++) {
        for (let j = 1; j <= a.length; j++) {
          if (b.charAt(i - 1) === a.charAt(j - 1))
            matrix[i][j] = matrix[i - 1][j - 1];
          else
            matrix[i][j] = Math.min(
              matrix[i - 1][j - 1] + 1,
              matrix[i][j - 1] + 1,
              matrix[i - 1][j] + 1
            );
        }
      }
      return matrix[b.length][a.length];
    }
    
    function similarity(s1, s2) {
      s1 = s1.toLowerCase();
      s2 = s2.toLowerCase();
      const distance = levenshtein(s1, s2);
      const maxLen = Math.max(s1.length, s2.length);
      if (maxLen === 0) return 1;
      return 1 - distance / maxLen;
    }
    
    function detect_intent(user_input) {
      let best_intent = null;
      let best_score = 0;
      for (const intent in intents) {
        for (const keyword of intents[intent].keywords) {
          let score = similarity(user_input, keyword);
          if (score > best_score) {
            best_score = score;
            best_intent = intent;
          }
        }
      }
      return (best_score >= 0.5) ? best_intent : null;
    }
    
    function generate_response(intent) {
      let responses = intents[intent].responses[chatbotPersonality] ||
                      intents[intent].responses.formal;
      let response = responses[Math.floor(Math.random() * responses.length)];
      if (intent === "greet") {
        const greetingTime = get_greeting_time();
        response = response.replace("{greeting_time}", greetingTime);
      }
      return response;
    }
    
    /******************************************************************
     * ADVANCED COMMANDS & CONTEXT MANAGEMENT
     ******************************************************************/
    function get_response(user_input) {
      let trimmed = user_input.trim();
      if (trimmed === "help") {
        return "‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ï‡§Æ‡§æ‡§Ç‡§°‡•ç‡§∏: 'help', 'settings, '‡§ö‡•á‡§Ç‡§ú ‡§™‡§∞‡•ç‡§∏‡§®‡•à‡§≤‡§ø‡§ü‡•Ä', 'Show History', '‡§Ø‡•Ç‡§ú‡§º‡§∞ ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤', '‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•ã' (‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§∏‡•á‡§∂‡§® ‡§∞‡•Ä‡§∏‡•á‡§ü), '‡§ú‡•ç‡§û‡§æ‡§® ‡§π‡§ü‡§æ‡§ì <‡§™‡•ç‡§∞‡§∂‡•ç‡§®>', '‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•ã <‡§™‡•ç‡§∞‡§∂‡•ç‡§®>', '‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§¨‡§§‡§æ‡§ì', '‡§Æ‡§ú‡§æ‡§ï ‡§∏‡•Å‡§®‡§æ‡§ì', '‡§â‡§¶‡•ç‡§ß‡§∞‡§£ ‡§¨‡§§‡§æ‡§ì', '‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•ã', '‡§≠‡§æ‡§∑‡§æ ‡§¨‡§¶‡§≤‡•ã'";
      }
      if (trimmed === "‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏" || trimmed === "‡§ö‡•á‡§Ç‡§ú ‡§™‡§∞‡•ç‡§∏‡§®‡•à‡§≤‡§ø‡§ü‡•Ä") {
        chatbotPersonality = (chatbotPersonality === "formal") ? "informal" : "formal";
        return `‡§ö‡•à‡§ü‡§¨‡•â‡§ü ‡§Ö‡§¨ ${chatbotPersonality} ‡§™‡§∞‡•ç‡§∏‡§®‡•à‡§≤‡§ø‡§ü‡•Ä ‡§Æ‡•á‡§Ç ‡§π‡•à‡•§`;
      }
      if (trimmed === "Show History") {
        let history = getCurrentSession().messages.map(m => m.sender + ": " + m.text).join("\n");
        return "Chat History:\n" + history;
      }
      if (trimmed === "‡§Ø‡•Ç‡§ú‡§º‡§∞ ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤") {
        return `‡§Ø‡•Ç‡§ú‡§º‡§∞ ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤:\n‡§®‡§æ‡§Æ: ${user_context.name || "‡§Ö‡§ú‡•ç‡§û‡§æ‡§§"}\n‡§™‡§ø‡§õ‡§≤‡§æ ‡§á‡§Ç‡§ü‡•á‡§Ç‡§ü: ${user_context.last_intent || "None"}`;
      }
      if (trimmed === "‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•ã" || trimmed === "‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§∏‡•á‡§∂‡§® ‡§∞‡•Ä‡§∏‡•á‡§ü") {
        user_context.conversation = [];
        return "‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§∏‡•á‡§∂‡§® ‡§ï‡§æ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§";
      }
      if (trimmed.startsWith("‡§ú‡•ç‡§û‡§æ‡§® ‡§π‡§ü‡§æ‡§ì")) {
        let qToRemove = trimmed.replace("‡§ú‡•ç‡§û‡§æ‡§® ‡§π‡§ü‡§æ‡§ì", "").trim();
        let idx = knowledgeBase.findIndex(entry => similarity(normalizeText(entry.question), normalizeText(qToRemove)) > 0.8);
        if (idx !== -1) {
          let removed = knowledgeBase.splice(idx, 1);
          return `‡§ú‡•ç‡§û‡§æ‡§® ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§π‡§ü‡§æ ‡§¶‡•Ä ‡§ó‡§à: "${removed[0].question}"`;
        } else {
          return "‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§ê‡§∏‡§æ ‡§ï‡•ã‡§à ‡§ú‡•ç‡§û‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ ‡§ú‡§ø‡§∏‡•á ‡§π‡§ü‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§";
        }
      }
      if (trimmed.startsWith("‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•ã")) {
        let qToEdit = trimmed.replace("‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•ã", "").trim();
        let idx = knowledgeBase.findIndex(entry => similarity(normalizeText(entry.question), normalizeText(qToEdit)) > 0.8);
        if (idx !== -1) {
          editingKnowledgeEntry = { index: idx, question: knowledgeBase[idx].question };
          return `‡§ï‡•É‡§™‡§Ø‡§æ ‡§®‡§Ø‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç, ‡§ú‡•ã "${knowledgeBase[idx].question}" ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§`;
        } else {
          return "‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§ê‡§∏‡§æ ‡§ï‡•ã‡§à ‡§ú‡•ç‡§û‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ ‡§ú‡§ø‡§∏‡•á ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§";
        }
      }
      if (trimmed === "‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§¨‡§§‡§æ‡§ì") {
        let convo = user_context.conversation;
        if (convo.length === 0) {
          return "‡§ï‡§®‡•ç‡§µ‡§∞‡•ç‡§∏‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§";
        }
        let summary = "‡§π‡§æ‡§≤‡§ø‡§Ø‡§æ ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂:\n";
        let recent = convo.slice(-5);
        recent.forEach(msg => {
          summary += `${msg.sender}: ${msg.text}\n`;
        });
        return summary;
      }
      if (trimmed === "‡§Æ‡§ú‡§æ‡§ï ‡§∏‡•Å‡§®‡§æ‡§ì") {
        let joke = jokes[Math.floor(Math.random() * jokes.length)];
        return joke;
      }
      if (trimmed === "‡§â‡§¶‡•ç‡§ß‡§∞‡§£ ‡§¨‡§§‡§æ‡§ì") {
        let quote = quotes[Math.floor(Math.random() * quotes.length)];
        return quote;
      }
      if (trimmed === "‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤‡•ã") {
        darkMode = !darkMode;
        if (darkMode) {
          document.body.style.backgroundColor = "#333";
          document.body.style.color = "#fff";
        } else {
          document.body.style.backgroundColor = "#f2f2f2";
          document.body.style.color = "#000";
        }
        return `‡§•‡•Ä‡§Æ ‡§¨‡§¶‡§≤ ‡§¶‡•Ä ‡§ó‡§à ‡§π‡•à: ${darkMode ? "‡§°‡§æ‡§∞‡•ç‡§ï ‡§Æ‡•ã‡§°" : "‡§≤‡§æ‡§á‡§ü ‡§Æ‡•ã‡§°"}`;
      }
      if (trimmed === "‡§≠‡§æ‡§∑‡§æ ‡§¨‡§¶‡§≤‡•ã") {
        return "‡§Ö‡§≠‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•á‡§µ‡§≤ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à‡•§";
      }
      if (trimmed.toLowerCase().startsWith("‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à")) {
        let name = trimmed.substring("‡§Æ‡•á‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à".length).trim();
        user_context.name = name;
        return `‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ ${name} ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§`;
      }
      let intent = detect_intent(trimmed);
      user_context.last_intent = intent;
      if (intent) {
        return generate_response(intent);
      }
      return null;
    }
    
    function extractLocationInfo(subject, sentence) {
      let words = sentence.split(" ");
      let index = words.findIndex(word => word.includes("‡§¨‡§∏‡§æ"));
      if (index > 0) {
        let locationWord = words[index-1];
        return subject + " " + locationWord + " ‡§¨‡§∏‡§æ ‡§π‡•á‡•§";
      }
      return sentence;
    }
    
    function processMessage(message) {
      if (editingKnowledgeEntry !== null) {
        knowledgeBase[editingKnowledgeEntry.index].answer = message;
        showTypingIndicator(() => {
          appendMessageToChat("bot", "‡§ú‡•ç‡§û‡§æ‡§® ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§");
        });
        editingKnowledgeEntry = null;
        return;
      }
      
      if (pendingQuestion !== null) {
        knowledgeBase.push({ question: pendingQuestion, answer: message });
        showTypingIndicator(() => {
          appendMessageToChat("bot", "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶! ‡§Æ‡•à‡§Ç‡§®‡•á ‡§®‡§Ø‡§æ ‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡•Ä‡§ñ ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à‡•§");
        });
        pendingQuestion = null;
        return;
      }
      
      const exitCommands = ["‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•ã", "‡§†‡•Ä‡§ï ‡§π‡•à ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•ã", "‡§¨‡§æ‡§Ø"];
      if (exitCommands.includes(message.trim().toLowerCase())) {
        showTypingIndicator(() => {
          appendMessageToChat("bot", "‡§´‡§ø‡§∞ ‡§Æ‡§ø‡§≤‡•á‡§Ç‡§ó‡•á! üëã");
        });
        return;
      }
      
      let processedMessage = translateToHindi(message);
      processedMessage = normalizeText(processedMessage);
      let sentiment = analyzeSentiment(processedMessage);
      user_context.conversation.push({ sender: "user", text: processedMessage, time: getTimestamp() });
      
      let intent_response = get_response(processedMessage);
      if (intent_response !== null) {
        if (sentiment === "negative")
          intent_response = "‡§Æ‡•Å‡§ù‡•á ‡§ñ‡•á‡§¶ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ ‡§â‡§¶‡§æ‡§∏ ‡§π‡•à‡§Ç‡•§ " + intent_response;
        showTypingIndicator(() => {
          appendMessageToChat("bot", intent_response);
          user_context.conversation.push({ sender: "bot", text: intent_response, time: getTimestamp() });
        });
        return;
      }
      
      if (processedMessage.indexOf("free fire") !== -1 || processedMessage.indexOf("freefire") !== -1) {
        let bestExtendedMatch = null;
        let bestExtendedScore = 0;
        extendedData.forEach(function(pair) {
          let normQuestion = normalizeText(pair.question);
          let score = similarity(processedMessage, normQuestion);
          if (score > bestExtendedScore) {
            bestExtendedScore = score;
            bestExtendedMatch = pair;
          }
        });
        if (bestExtendedMatch && bestExtendedScore >= 0.6) {
          showTypingIndicator(() => {
            appendMessageToChat("bot", bestExtendedMatch.answer);
            user_context.conversation.push({ sender: "bot", text: bestExtendedMatch.answer, time: getTimestamp() });
          });
          return;
        }
      }
      
      for (let subject in subjectData) {
        if (processedMessage.indexOf(subject) !== -1) {
          let content = subjectData[subject];
          let sentences = content.split(/\.|\?|!/);
          let bestSentence = "";
          let bestSentenceScore = 0;
          sentences.forEach(sentence => {
            let score = similarity(processedMessage, sentence);
            if (score > bestSentenceScore) {
              bestSentenceScore = score;
              bestSentence = sentence;
            }
          });
          if (bestSentence && bestSentenceScore >= 0.5) {
            if (processedMessage.includes("‡§ï‡§π‡§æ") && processedMessage.includes("‡§¨‡§∏‡§æ")) {
              let response = extractLocationInfo(subject, bestSentence);
              showTypingIndicator(() => {
                appendMessageToChat("bot", response);
                user_context.conversation.push({ sender: "bot", text: response, time: getTimestamp() });
              });
              return;
            } else {
              showTypingIndicator(() => {
                appendMessageToChat("bot", bestSentence.trim());
                user_context.conversation.push({ sender: "bot", text: bestSentence.trim(), time: getTimestamp() });
              });
              return;
            }
          }
        }
      }
      
      let bestMatch = null;
      let bestScore = 0;
      knowledgeBase.forEach(function(pair) {
        let normQuestion = normalizeText(pair.question);
        let score = similarity(processedMessage, normQuestion);
        if (score > bestScore) {
          bestScore = score;
          bestMatch = pair;
        }
      });
      if (bestMatch && bestScore >= 0.6) {
        showTypingIndicator(() => {
          appendMessageToChat("bot", bestMatch.answer);
          user_context.conversation.push({ sender: "bot", text: bestMatch.answer, time: getTimestamp() });
        });
        return;
      }
      
      showTypingIndicator(() => {
        appendMessageToChat("bot", "‡§Æ‡•Å‡§ù‡•á ‡§á‡§∏‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§™‡§§‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§Ç:");
        user_context.conversation.push({ sender: "bot", text: "‡§Æ‡•Å‡§ù‡•á ‡§á‡§∏‡§ï‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§™‡§§‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•á‡§Ç:", time: getTimestamp() });
      });
      pendingQuestion = message;
    }
    
    /******************************************************************
     * SESSION & CHAT WINDOW HELPER FUNCTIONS
     ******************************************************************/
    function saveSessions() {
      localStorage.setItem("chatSessions", JSON.stringify(sessions));
    }
    
    function getCurrentSession() {
      return sessions.find(session => session.id === currentSessionId);
    }
    
    function appendMessageToChat(sender, message) {
      const chatWindow = document.getElementById("chat-window");
      const messageDiv = document.createElement("div");
      messageDiv.className = "message " + sender;
      messageDiv.innerHTML = escapeHTML(message);
      const timeSpan = document.createElement("span");
      timeSpan.className = "timestamp";
      timeSpan.innerText = getTimestamp();
      messageDiv.appendChild(timeSpan);
      chatWindow.appendChild(messageDiv);
      chatWindow.scrollTop = chatWindow.scrollHeight;
      let currentSession = getCurrentSession();
      currentSession.messages.push({ sender: sender, text: message, time: getTimestamp() });
      saveSessions();
    }
    
    function loadCurrentSessionMessages() {
      const chatWindow = document.getElementById("chat-window");
      chatWindow.innerHTML = "";
      let currentSession = getCurrentSession();
      currentSession.messages.forEach(msg => {
        const messageDiv = document.createElement("div");
        messageDiv.className = "message " + msg.sender;
        messageDiv.innerHTML = escapeHTML(msg.text);
        const timeSpan = document.createElement("span");
        timeSpan.className = "timestamp";
        timeSpan.innerText = msg.time;
        messageDiv.appendChild(timeSpan);
        chatWindow.appendChild(messageDiv);
      });
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }
    
    function renderSessionList() {
      const sessionListDiv = document.getElementById("session-list");
      sessionListDiv.innerHTML = "";
      sessions.forEach(session => {
        const sessionDiv = document.createElement("div");
        sessionDiv.className = "session-item" + (session.id === currentSessionId ? " active" : "");
        sessionDiv.innerText = session.title;
        sessionDiv.addEventListener("click", () => {
          currentSessionId = session.id;
          localStorage.setItem("currentSessionId", currentSessionId);
          updateSessionTitle();
          loadCurrentSessionMessages();
          renderSessionList();
        });
        const deleteBtn = document.createElement("button");
        deleteBtn.className = "delete-session";
        deleteBtn.innerText = "√ó";
        deleteBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          if (confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§á‡§∏ ‡§ö‡•à‡§ü ‡§∏‡§§‡•ç‡§∞ ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?")) {
            sessions = sessions.filter(s => s.id !== session.id);
            if (currentSessionId === session.id) {
              if (sessions.length > 0) {
                currentSessionId = sessions[0].id;
                localStorage.setItem("currentSessionId", currentSessionId);
              } else {
                currentSessionId = "session-" + Date.now();
                sessions.push({ id: currentSessionId, title: "New Chat", messages: [] });
                localStorage.setItem("currentSessionId", currentSessionId);
              }
            }
            saveSessions();
            renderSessionList();
            loadCurrentSessionMessages();
            updateSessionTitle();
          }
        });
        sessionDiv.appendChild(deleteBtn);
        sessionListDiv.appendChild(sessionDiv);
      });
    }
    
    function updateSessionTitle() {
      document.getElementById("session-title").innerText = getCurrentSession().title;
    }
    
    function showTypingIndicator(callback) {
      const indicator = document.getElementById("typing-indicator");
      indicator.style.display = "block";
      setTimeout(() => {
        indicator.style.display = "none";
        callback();
      }, 1000);
    }
    
    /******************************************************************
     * EVENT HANDLERS
     ******************************************************************/
    document.getElementById("send-button").addEventListener("click", () => {
      let userInput = document.getElementById("user-input").value.trim();
      if (userInput === "") return;
      appendMessageToChat("user", userInput);
      processMessage(userInput);
      document.getElementById("user-input").value = "";
    });
    
    document.getElementById("user-input").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        document.getElementById("send-button").click();
      }
    });
    
    document.getElementById("clear-chat-btn").addEventListener("click", () => {
      if (confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§∏‡§æ‡§∞‡§æ ‡§ö‡•à‡§ü ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?")) {
        let currentSession = getCurrentSession();
        currentSession.messages = [];
        saveSessions();
        loadCurrentSessionMessages();
      }
    });
    
    document.getElementById("new-session-btn").addEventListener("click", () => {
      currentSessionId = "session-" + Date.now();
      let newSession = { id: currentSessionId, title: "New Chat", messages: [] };
      sessions.push(newSession);
      localStorage.setItem("currentSessionId", currentSessionId);
      saveSessions();
      renderSessionList();
      loadCurrentSessionMessages();
      updateSessionTitle();
    });
    
    // JSON ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§á‡§®‡§ø‡§∂‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç
    loadData().then(() => {
      renderSessionList();
      loadCurrentSessionMessages();
      updateSessionTitle();
      if (getCurrentSession().messages.length === 0) {
        appendMessageToChat("bot", "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡•à‡§∏‡•á ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å?");
      }
    });
  </script>
</body>
</html>